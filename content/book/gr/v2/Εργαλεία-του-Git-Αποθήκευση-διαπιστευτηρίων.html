---
category: book
section: documentation
subsection: book
sidebar: book
book:
  language_code: gr
  chapter:
    title: Εργαλεία του Git
    number: 7
  section:
    title: Αποθήκευση διαπιστευτηρίων
    number: 14
    cs_number: '7.14'
    previous: book/gr/v2/Εργαλεία-του-Git-Replace
    next: book/gr/v2/Εργαλεία-του-Git-Ανακεφαλαίωση
title: Git - Αποθήκευση διαπιστευτηρίων

---
<h2 id="r_credential_caching">Αποθήκευση διαπιστευτηρίων</h2>
<div class="paragraph">
<p>

Εάν χρησιμοποιούμε τη μεταφορά μέσω SSH για τη σύνδεση με απομακρυσμένα αποθετήρια, είναι πιθανό να έχουμε ένα κλειδί χωρίς κωδική φράση, η οποία μας επιτρέπει να μεταφέρουμε δεδομένα με ασφάλεια χωρίς να πληκτρολογούμε το όνομα χρήστη και τον κωδικό πρόσβασής μας.
Ωστόσο, αυτό δεν είναι δυνατό με τα πρωτόκολλα HTTP —κάθε σύνδεση χρειάζεται ένα όνομα χρήστη και έναν κωδικό πρόσβασης.
Αυτό γίνεται ακόμα πιο δύσκολο για συστήματα με ταυτοποίηση δύο παραγόντων, όπου το διακριτικό (token) που χρησιμοποιούμε για έναν κωδικό πρόσβασης παράγεται τυχαία και δεν μπορεί να ωθηθεί.</p>
</div>
<div class="paragraph">
<p>Ευτυχώς, το Git διαθέτει ένα σύστημα διαπιστευτηρίων που μπορεί να μας βοηθήσει σε αυτό το πρόβλημα με περισσότερες από μία επιλογές:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Η προεπιλογή είναι να μην αποθηκεύει καθόλου διαπιστευτήρια.
  Κάθε σύνδεση θα μας ζητάει το όνομα χρήστη και τον κωδικό πρόσβασής μας.</p>
</li>
<li>
<p>Κατά τη λειτουργία <code>cache</code> διατηρεί τα διαπιστευτήρια στη μνήμη για ορισμένο χρονικό διάστημα.
  Κανένας από τους κωδικούς πρόσβασης δεν αποθηκεύεται ποτέ στον δίσκο και οι κωδικοί πρόσβασης διαγράφονται από την προσωρινή μνήμη μετά από 15 λεπτά.</p>
</li>
<li>
<p>Κατά τη λειτουργία <code>store</code> τα διαπιστευτήρια αποθηκεύονται σε ένα αρχείο απλού κειμένου στον δίσκο και δεν εκπνέουν ποτέ.
  Αυτό σημαίνει ότι μέχρι να αλλάξουμε τον κωδικό πρόσβασης για τον κεντρικό υπολογιστή Git, δεν θα χρειαστεί ποτέ να πληκτρολογήσουμε ξανά τα διαπιστευτήριά μας.
  Το μειονέκτημα αυτής της προσέγγισης είναι ότι οι κωδικοί πρόσβασης αποθηκεύονται σε αρχείο απλού κειμένου στον προσωπικό μας κατάλογο.</p>
</li>
<li>
<p>Εάν χρησιμοποιούμε Mac, το Git έρχεται με τη λειτουργία <code>osxkeychain</code>, η οποία αποθηκεύει τα διαπιστευτήρια στην ασφαλή κλειδοθήκη (keychain) που είναι συνδεδεμένη με το λογαριασμό μας στο σύστημα.
  Αυτή η μέθοδος αποθηκεύει τα διαπιστευτήριά μας στον δίσκο και δεν λήγει ποτέ, αλλά είναι κρυπτογραφημένα με το ίδιο σύστημα που αποθηκεύει τα πιστοποιητικά HTTPS και την αυτόματη συμπλήρωση του Safari.</p>
</li>
<li>
<p>Εάν χρησιμοποιούμε Windows, μπορούμε να εγκαταστήσουμε έναν βοηθό που ονομάζεται <code>winstore</code>.
  Είναι παρόμοιος με τον βοηθό <code>osxkeychain</code> που περιγράφεται παραπάνω, αλλά χρησιμοποιεί το Windows Credential Store (Χώρος Αποθήκευσης Διαπιστευτηρίων) για τον έλεγχο ευαίσθητων πληροφοριών.
  Διατίθεται στη διεύθυνση <a href="https://gitcredentialstore.codeplex.com" class="bare">https://gitcredentialstore.codeplex.com</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Μπορούμε να επιλέξουμε μία από αυτές τις μεθόδους ρυθμίζοντας την τιμή μίας μεταβλητής διαμόρφωσης του Git:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git config --global credential.helper cache</code></pre>
</div>
</div>
<div class="paragraph">
<p>Μερικοί από αυτούς τους βοηθούς έχουν επιλογές.
Ο βοηθός <code>store</code> μπορεί να πάρει ένα όρισμα <code>--file &lt;διαδρομή&gt;</code>, το οποίο καθορίζει πού θα αποθηκεύεται το αρχείο απλού κειμένου (η προεπιλογή είναι το <code>~/.git-credentials</code>).
Ο βοηθός <code>cache</code> δέχεται την επιλογή <code>--timeout &lt;δευτερόλεπτα&gt; ', η οποία αλλάζει το χρονικό διάστημα για το οποίο ο δαίμονάς του συνεχίζει να τρέχει (η προεπιλογή είναι `900</code>, δηλαδή 15 λεπτά).
Ακολουθεί ένα παράδειγμα του πώς θα ρυθμίζουμε τον βοηθό <code>store</code> με ένα όνομα προσαρμοσμένου αρχείου:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git config --global credential.helper store --file ~/.my-credentials</code></pre>
</div>
</div>
<div class="paragraph">
<p>Το Git ακόμη μας επιτρέπει να ρυθμίσουμε διάφορους βοηθούςς.
Όταν αναζητάμε διαπιστευτήρια για έναν συγκεκριμένο κεντρικό υπολογιστή, το Git θα τα εξετάζει με τη σειρά και θα σταματήσει μετά την πρώτη απάντηση.
Κατά την αποθήκευση διαπιστευτηρίων, το Git θα στείλει το όνομα χρήστη και τον κωδικό πρόσβασης σε <strong>όλους</strong> τους βοηθούς της λίστας και αυτοί μπορούν να επιλέξουν τι να τους κάνουν.
Ακολουθεί ένα παράδειγμα του πώς θα έμοιαζε το <code>.gitconfig</code> αν είχαμε ένα αρχείο διαπιστευτηρίων σε ένα USB stick, αλλά θέλαμε να χρησιμοποιήσουμε την προσωρινή μνήμη για να γλιτώσουμε λίγη πληκτρολόγηση εάν η μονάδα δεν είναι συνδεδεμένη:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ini" data-lang="ini">[credential]
    helper = store --file /mnt/thumbdrive/.git-credentials
    helper = cache --timeout 30000</code></pre>
</div>
</div>
<div class="sect3">
<h3 id="_πώς_λειτουργεί">Πώς λειτουργεί</h3>
<div class="paragraph">
<p>Πώς λειτουργεί όλο αυτό;
Η βασική εντολή του Git για το σύστημα βοηθών διαπιστευτηρίων είναι η <code>git credential</code>, η οποία παίρνει μια εντολή ως όρισμα και άλλες εισόδους από το stdin.</p>
</div>
<div class="paragraph">
<p>Αυτό είναι ίσως ευκολότερο να κατανοηθεί με ένα παράδειγμα.
Ας υποθέσουμε ότι ένας βοηθός διαπιστευτηρίων έχει ρυθμιστεί και ο βοηθός έχει αποθηκεύσει τα διαπιστευτήρια για τον διακομιστή <code>mygithost</code>.
Ακολουθεί μια συνεδρία που χρησιμοποιεί την εντολή <code>fill</code>, η οποία ενεργοποιείται όταν το Git προσπαθεί να βρει διαπιστευτήρια για έναν διακομιστή:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git credential fill  <b class="conum">(1)</b>
protocol=https         <b class="conum">(2)</b>
host=mygithost
                       <b class="conum">(3)</b>
protocol=https         <b class="conum">(4)</b>
host=mygithost
username=bob
password=s3cre7
$ git credential fill  <b class="conum">(5)</b>
protocol=https
host=unknownhost

Username for 'https://unknownhost': bob
Password for 'https://bob@unknownhost':
protocol=https
host=unknownhost
username=bob
password=s3cre7</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Αυτή είναι η γραμμή εντολών που ενεργοποιεί την αλληλεπίδραση.</p>
</li>
<li>
<p>Η <code>git credential</code> στη συνέχεια αναμένει είσοδο από το stdin.
    Το παρέχουμε με αυτά που γνωρίζουμε: το πρωτόκολλο και το όνομα του κεντρικού υπολογιστή.</p>
</li>
<li>
<p>Μια κενή γραμμή υποδεικνύει ότι η είσοδος είναι πλήρης και το σύστημα διαπιστευτηρίων πρέπει να απαντήσει με αυτό που γνωρίζει.</p>
</li>
<li>
<p>Η <code>git credential</code> γράφει στο stdout τις πληροφορίες που βρήκε.</p>
</li>
<li>
<p>Εάν δεν εντοπιστούν διαπιστευτήρια, το Git ζητάει από τον χρήστη το όνομα χρήστη και τον κωδικό πρόσβασης και τα επαναφέρει στην κλήση του stdout (εδώ είναι συνδεδεμένα στην ίδια κονσόλα).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Το σύστημα διαπιστευτηρίων στην πραγματικότητα καλεί ένα πρόγραμμα που είναι ξεχωριστό από το ίδιο το Git· ποιο πρόγραμμα και πώς το καλεί εξαρτάται από την τιμή της μεταβλητής ρύθμισης <code>credential.helper</code>.
Μπορεί να πάρει διάφορες μορφές:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration Value</th>
<th class="tableblock halign-left valign-top">Behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>foo</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Runs <code>git-credential-foo</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>foo -a --opt=bcd</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Runs <code>git-credential-foo -a --opt=bcd</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/absolute/path/foo -xyz</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Runs <code>/absolute/path/foo -xyz</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>!f() { echo "password=s3cre7"; }; f</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code after <code>!</code> evaluated in shell</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Έτσι οι βοηθοί που περιγράφηκαν παραπάνω στην πραγματικότητα ονομάζονται <code>git-credential-cache</code>, <code>git-credential-store</code> κ.ο.κ. και μπορούμε να τους ρυθμίσουμε ώστε να λάβουν ορίσματα από τη γραμμή εντολών.
Η γενική μορφή είναι <code>git-credential-foo [args] &lt;ενέργεια&gt;</code>.
Το πρωτόκολλο stdin/stdout είναι το ίδιο με αυτό της <code>git-credential</code>, αλλά χρησιμοποιούν ένα ελαφρώς διαφορετικό σύνολο ενεργειών:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>get</code> είναι ένα αίτημα για ένα ζεύγος ονόματος χρήστη/κωδικού πρόσβασης.</p>
</li>
<li>
<p><code>store</code> είναι ένα αίτημα για να αποθηκεύσουμε ένα σύνολο διαπιστευτηρίων στη μνήμη αυτού του βοηθού.</p>
</li>
<li>
<p><code>erase</code> είναι αίτημα διαγραφής των διαπιστευτηρίων για τις δοσμένες ιδιότητες από τη μνήμη αυτού του βοηθού.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Για τις ενέργειες <code>store</code> και <code>delete</code>, δεν απαιτείται απάντηση (το Git τις αγνοεί ούτως ή άλλως).
Για την ενέργεια <code>get</code>, ωστόσο, το Git ενδιαφέρεται πολύ για το τι έχει να πει ο βοηθός.
Αν ο βοηθός δεν γνωρίζει τίποτα χρήσιμο, μπορεί απλά να τερματίσει χωρίς έξοδο, αλλά αν γνωρίζει, θα πρέπει να αυξήσει τις παρεχόμενες πληροφορίες με τις πληροφορίες που έχει αποθηκεύσει.
Η έξοδος αντιμετωπίζεται σαν μια ακολουθία δηλώσεων εκχώρησης· ο,τιδήποτε παρέχεται θα αντικαταστήσει αυτό που ήδη γνωρίζει το Git.</p>
</div>
<div class="paragraph">
<p>Ακολουθεί το ίδιο παράδειγμα όπως προηγουμένως, αλλά παρακάμπτοντας την <code>git-credential</code> και πηγαίνοντας κατευθείαν στην <code>git-credential-store</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git credential-store --file ~/git.store store  <b class="conum">(1)</b>
protocol=https
host=mygithost
username=bob
password=s3cre7
$ git credential-store --file ~/git.store get    <b class="conum">(2)</b>
protocol=https
host=mygithost

username=bob                                     <b class="conum">(3)</b>
password=s3cre7</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Εδώ λέμε στην <code>git-credential-store</code> να αποθηκεύσει κάποια διαπιστευτήρια: το όνομα χρήστη <code>bob</code> και ο κωδικός πρόσβασης <code>s3cre7</code> πρέπει να χρησιμοποιούνται όταν προσπελασζουμε τη διεύθυνση <code>https://mygithost</code>.</p>
</li>
<li>
<p>Τώρα ανακτούμε αυτά τα διαπιστευτήρια.
    Παρέχουμε τα τμήματα της σύνδεσης που ήδη γνωρίζουμε (<code>https://mygithost</code>) και μια κενή γραμμή.</p>
</li>
<li>
<p>Η <code>git-credential-store</code> απαντά με το όνομα χρήστη και τον κωδικό πρόσβασης που αποθηκεύσαμε παραπάνω.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Το αρχείο <code>~/git.store</code> τώρα μοιάζει με αυτό:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>https://bob:s3cre7@mygithost</code></pre>
</div>
</div>
<div class="paragraph">
<p>Είναι μόνο για μια σειρά γραμμών, καθεμία από τις οποίες περιέχει μια διεύθυνση URL διακοσμημένη με διαπιστευτήρια.
Οι βοηθοί <code>osxkeychain</code> και <code>winstore</code> χρησιμοποιούν την εγγενή μορφή των καταστημάτων υποστήριξης, ενώ η <code>cache</code> χρησιμοποιεί τη δική της μορφή μνήμης (η οποία δεν μπορεί να διαβάσει καμία άλλη διαδικασία).</p>
</div>
</div>
<div class="sect3">
<h3 id="_μία_εξατομικευμένη_προσωρινή_μνήμη_διαπιστευτηρίων">Μία εξατομικευμένη προσωρινή μνήμη διαπιστευτηρίων</h3>
<div class="paragraph">
<p>Δεδομένου ότι η <code>git-credential-store</code> και οι φίλοι της είναι προγράμματα ξεχωριστά από το Git, δεν είναι και μεγάλο διανοητικό άλμα να συνειδητοποιήσουμε ότι <em>οποιοδήποτε</em> πρόγραμμα μπορεί να είναι βοηθός διαπιστευτηρίων Git.
Οι βοηθοί που παρέχονται από το Git καλύπτουν πολλές κοινές περιπτώσεις χρήσης αλλά όχι όλες.
Για παράδειγμα, ας υποθέσουμε ότι η ομάδα μας έχει ορισμένα διαπιστευτήρια που είναι κοινά σε ολόκληρη την ομάδα, ίσως για ανάπτυξη.
Αυτά αποθηκεύονται σε έναν κοινόχρηστο κατάλογο, αλλά δεν θέλουμε να τα αντιγράψουμε στο δικό μας κατάστημα διαπιστευτηρίων, επειδή αλλάζουν συχνά.
Κανένας από τους υπάρχοντες βοηθούς δεν καλύπτει αυτήν την περίπτωση· ας δούμε τι θα χρειαζόταν για να γράψουμε το δικό μας.
Υπάρχουν πολλά χαρακτηριστικά-κλειδά που πρέπει να έχει ένα τέτοιο πρόγραμμα:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Η μόνη ενέργεια την οποία πρέπει να προσέξουμε πολύ είναι η <code>get</code>· Οι <code>store</code> και <code>erase</code> είναι λειτουργίες εγγραφής, επομένως απλά θα τερματίσουμε χωρίς έξοδο όταν τις λάβουμε.</p>
</li>
<li>
<p>Η μορφή αρχείου του αρχείου κοινόχρηστων διαπιστευτηρίων είναι ίδια με αυτήν που χρησιμοποιείται από την <code>git-credential-store</code>.</p>
</li>
<li>
<p>Η τοποθεσία αυτού του αρχείου είναι αρκετά τυπική, αλλά θα πρέπει να δώσουμε τη δυνατότητα στον χρήστη να δίνει άλλη διαδρομή στην περίπτωση που το θέλει.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Επαναλαμβάνουμε ότι θα γράψουμε αυτήν την επέκταση σε Ruby, αλλά οποιαδήποτε γλώσσα θα λειτουργήσει εφόσον το Git μπορεί να εκτελέσει το τελικό προϊόν.
Εδώ είναι ο πλήρης πηγαίος κώδικας του νέου μας βοηθού διαπιστευτηρίων:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-ruby" data-lang="ruby">#!/usr/bin/env ruby

require 'optparse'

path = File.expand_path '~/.git-credentials' # <b class="conum">(1)</b>
OptionParser.new do |opts|
    opts.banner = 'USAGE: git-credential-read-only [options] &lt;action&gt;'
    opts.on('-f', '--file PATH', 'Specify path for backing store') do |argpath|
        path = File.expand_path argpath
    end
end.parse!

exit(0) unless ARGV[0].downcase == 'get' # <b class="conum">(2)</b>
exit(0) unless File.exists? path

known = {} # <b class="conum">(3)</b>
while line = STDIN.gets
    break if line.strip == ''
    k,v = line.strip.split '=', 2
    known[k] = v
end

File.readlines(path).each do |fileline| # <b class="conum">(4)</b>
    prot,user,pass,host = fileline.scan(/^(.*?):\/\/(.*?):(.*?)@(.*)$/).first
    if prot == known['protocol'] and host == known['host'] then
        puts "protocol=#{prot}"
        puts "host=#{host}"
        puts "username=#{user}"
        puts "password=#{pass}"
        exit(0)
    end
end</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Εδώ αναλύουμε τις επιλογές της γραμμής εντολών, επιτρέποντας στον χρήστη να καθορίσει το αρχείο εισόδου. Η προεπιλογή είναι <code>~/.git-credentials</code>.</p>
</li>
<li>
<p>Αυτό το πρόγραμμα αποκρίνεται μόνον εάν η ενέργεια είναι <code>get</code> και το αρχείο backing-store υπάρχει.</p>
</li>
<li>
<p>Αυτός ο βρόχος διαβάζει από την stdin μέχρι να συναντήσει την πρώτη κενή γραμμή.
    Οι είσοδοι αποθηκεύονται στο πίνακα αναζήτηση <code>known</code> για μεταγενέστερη αναφορά.</p>
</li>
<li>
<p>Αυτός ο βρόχος διαβάζει τα περιεχόμενα του αρχείου αποθήκευσης αναζητώντας αντιστοιχίες.
    Εάν το πρωτόκολλο και ο κεντρικός υπολογιστής από τη μεταβλητή  <code>known</code> ταιριάζουν με αυτήν τη γραμμή, το πρόγραμμα εκτυπώνει τα αποτελέσματα στην stdout και τερματίζει.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Αποθηκεύουμε τον βοηθό μας ως <code>git-credential-read-only</code>, τον βάζουμε κάπου στο <code>PATH</code> μας και τον επισημόνουμε ως εκτελέσιμο.
Ακολουθεί μια διαδραστική συνεδρία:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git credential-read-only --file=/mnt/shared/creds get
protocol=https
host=mygithost

protocol=https
host=mygithost
username=bob
password=s3cre7</code></pre>
</div>
</div>
<div class="paragraph">
<p>Επειδή το όνομά του ξεκινάει με <code>git-</code>, μπορούμε να χρησιμοποιήσουμε την απλή σύνταξη για την τιμή της μεταβλητής ρύθμισης:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git config --global credential.helper read-only --file /mnt/shared/creds</code></pre>
</div>
</div>
<div class="paragraph">
<p>Όπως μπορούμε να δούμε, η επέκταση αυτού του συστήματος είναι αρκετά απλή και μπορεί να λύσει μερικά κοινά προβλήματα για εμάς και την ομάδα μας.</p>
</div>
</div>
<div id="nav"><a href="{{< previous-section >}}">prev</a> | <a href="{{< next-section >}}">next</a></div>